language: python

python:
  - 2.7 #.14
  - 3.7 #.0 
  - pypy3 #6.0.0

#runtime:
#  - nodePool: dynamic__x86_64__Ubuntu_16_04__c4_large
#  - nodePool: dynamic__x86_64__Ubuntu_14_04__c4_xlarge
#  - nodePool: dynamic__x86_64__CentOS_7__c4_large

runtime:
  - nodePool: dynamic__x86_64__Ubuntu_14_04__c4_xlarge
    build:
      pre_ci:
        - echo "pre-ci section"
        - docker build -t=shippabledocker/sample-node:runtimebuild .
        
      pre_ci_boot:
        image_name: drydock/u16pytall
        image_tag: master
        pull: true
        options: '--privileged=true --net=bridge -e FOO=trueFromRuntimeBuild -e BOO=falseFromRuntimeBuild'
        
      ci:
        - echo "CI from runtimebuild section"
        
      post_ci:
        - docker push shippabledocker/sample-node:runtimebuild
        
      on_success:
        - echo "on success form runtime build"
        
      on_failure:
        - echo "on failure form runtime build"
        
      cache: true
    #  cache_dir_list:
    #    - #dir1
    
      push:
        - docker push shippabledocker/sample-node:master.50
        
      always:
        - docker push shippabledocker/sample-node:master.40
        
integrations:
  hub:

 #Docker integration
    - integrationName: ship-docker
      type: dockerRegistryLogin
